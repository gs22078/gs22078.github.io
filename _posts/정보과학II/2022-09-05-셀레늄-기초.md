---
title: 정보과학II > 셀레늄 기초
author: js
date: 2023-09-05
categories: [Class, 정보과학II]
tags: [class, informatics, web_crawling]
math: true
---

이 글은 셀레늄의 기초적인 사용 방법을 다룬다.

## 셀레늄 실행
---
```python
from selenium import webdriver
from selenium.webdriver.chrome.service import Service
import time

service = Service(executable_path="/path/to/chromedriver")
driver = webdriver.Chrome(service=service)
driver.get('https://google.com/')
time.sleep(2)

driver.quit()
```

위 코드를 실행했을 때, 크롬 브라우저가 열리고, `google.com`에 들어가고, 몇 초 뒤에 꺼졌다면 실행이 잘 된 것이다.

만약, `The system cannot find the file specified.`나 `WebDriverException: Message: 'chromedriver' executable needs to be available in the path.`와 같은 오류가 난다면, `/path/to/chromedriver.exe`에 chromedriver 파일(Windows의 경우, .exe 확장자까지 입력)의 위치를 정확히 입력했는지 확인해 보자.

## 셀레늄 기초
---
셀레늄으로 브라우저를 실행하는 것은 위 코드로 할 수 있다. 이때, `driver.get('https://google.com')`은 해당 주소로 크롬을 여는 코드이고, `time.sleep(2)`는 2초 동안 기다리는 코드, `driver.quit()`은 크롬 드라이버를 종료하는 코드이다.

어떤 주소에 들어간 뒤, 특정 링크나 버튼, 텍스트 등을 찾기 위해서는 `find_element`, 찾는 것이 페이지에 2개 이상 있는 경우, `find_elements`를 사용한다.

`google.com`의 주소로 들어가서 `Ctrl + Shift + C`를 누르고, 검색바의 위치에 커서를 올려 놓으면,

```html
<input class="gLFyf gsfi" jsaction="paste:puy29d;" maxlength="2048" name="q" type="text" aria-autocomplete="both" aria-haspopup="false" autocapitalize="off" autocomplete="off" autocorrect="off" autofocus="" role="combobox" spellcheck="false" title="Search" value="" aria-label="Search">
```
와 같은 코드를 찾을 수 있다. 여기에서 `Ctrl + F`로 `name="q"`를 찾아보면, `name="q"`를 가진 element가 검색바로 유일함을 알 수 있다.

따라서, 검색바의 위치를 셀레늄으로 찾기 위해서는, 다음과 같이 코드를 짜면 된다.

```python
from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.common.by import By
import time

service = Service(executable_path="/path/to/chromedriver")
driver = webdriver.Chrome(service=service)
driver.get('https://google.com/')

search_bar = driver.find_element(By.NAME, 'q')

time.sleep(2)

driver.quit()
```

코드의 앞부분에 `from selenium.webdriver.common.by import By`가 추가되었다. `driver.find_element(By.NAME, 'q')`에서, `name="q"`인 element를 찾는다. `name="q"`인 element는 검색바가 유일하므로 검색바의 위치를 찾을 수 있는 것이다.

이렇게 찾은 `search_bar`에는 다양한 작업을 수행할 수 있는데, 자주 사용하는 것으로 `click()`이나 `send_keys()` 등이 있다.

```python
import time
from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.common.by import By
import time

service = Service(executable_path="/path/to/chromedriver")
driver = webdriver.Chrome(service=service)
driver.get('https://google.com/')

search_bar = driver.find_element(By.NAME, 'q')
seach_bar.click()

time.sleep(2)

driver.quit()
```
위 코드를 실행하면, 검색바에 커서가 생기고, focus 되는 것을 볼 수 있다. 위 코드에서, `search_bar.click()` 대신, `search_bar.send_keys("Google")`로 바꾸면, 검색바에 Google을 입력하는 것을 볼 수 있다.

또, `search_bar.send_keys("Google\n")`로 바꾸면, 엔터 키까지 눌러 Google이 검색된다. `\n` 대신, 코드의 앞부분에 `from selenium.webdriver.common.keys import Keys`를 추가하고, `search_bar.send_keys("Google" + Keys.ENTER)`로 쓸 수도 있다.

기초적인 것을 몇 가지 해 보았으니, 이제 좀더 자세히 알아 보자.

## Web Element 찾기.
---
